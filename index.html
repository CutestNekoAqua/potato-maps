<!doctype html>
<html lang="en">
<!-- Der Head -->

<head>
  <link rel="stylesheet" href="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.3.0/css/ol.css"
    type="text/css">
  <style>
    .map {
      height: 100%;
      width: 100%;
    }
  </style>
  <script src="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.3.0/build/ol.js"></script>
  <title>Potat0 Maps</title>
</head>

<body>
  <!-- Die Buttons/Der Button -->
  <h2>Navigieren: </h2>
  <div id="buttons"></div>

  <!-- Die Karte -->
  <div id="map" class="map"></div>

  <!-- Anfang vom Javascript -->
  <script type="text/javascript">
    window.onload = function () {
      /* Definierung von Long und Lat */
      let args = window.location.search;
      console.log(args);
      let long = 14.2454676;
      let lat = 51.4390602;
      args.split('?');

      var poi0 = { name: "Johanneum", id: "hoyjohanneum", coordinates: [14.24694, 51.43609] };
      var poi1 = { name: "ZCOM", id: "hoyzcom", coordinates: [14.25608, 51.43744] };
      var locations = [poi0, poi1];

      var iconStyle = new ol.style.Style({
        image: new ol.style.Icon({
          anchor: [0.5, 46],
          anchorXUnits: 'fraction',
          anchorYUnits: 'pixels',
          src: 'icon.png'
        })
      });

      function createClickListener(locObj) {
        return function() {
          var point = ol.proj.fromLonLat(locObj.coordinates);
          var size = map.getSize();
          view1.centerOn(point, size, [570, 500]);
          console.log(locObj.id);
        }
      }

      var buttonsDiv = document.getElementById('buttons');
     
      // pins
      var iconFeatureList = [];
      for (var locIndex in locations) {
        var locObj = locations[locIndex];
        var buttonelement = document.createElement('button');
        buttonelement.innerHTML = "<button id=\""+locObj.id+"\">"+locObj.name+"</button>";
        buttonsDiv.appendChild(buttonelement);
        
        /* Damit etwas passiert, wenn man auf den Button klickt */
        buttonelement.addEventListener('click', createClickListener(locObj))

        var iconFeature = new ol.Feature({
          geometry: new ol.geom.Point(ol.proj.fromLonLat(locObj.coordinates)),
        });
        iconFeature.setStyle(iconStyle);
        iconFeatureList.push(iconFeature);
      }



      /* Die verschiedenen Layer */
      var vectorSource = new ol.source.Vector({
        features: iconFeatureList
      });

      var vectorLayer = new ol.layer.Vector({
        source: vectorSource
      });

      /* Für die Karte benötigtes Zeug */
      var properties = {
        center: ol.proj.fromLonLat([long, lat]),
        zoom: 19
      }
      var view1 = new ol.View(properties)

      var map = new ol.Map({
        target: 'map',
        layers: [

          new ol.layer.Tile({
            source: new ol.source.OSM()
          }), vectorLayer

        ],
        view: view1
      });
    }
  </script>
</body>

</html>